<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SP Tattoo Ink - Profesionalno Tetoviranje</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <style>
        * {
            scroll-behavior: smooth;
        }
        
        body {
            box-sizing: border-box;
            background: #0a0a0a;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
        }
        
        .tattoo-bg {
            background: linear-gradient(180deg, #0a0a0a 0%, #111111 50%, #0a0a0a 100%);
            background-attachment: fixed;
        }
        
        .calendar-day {
            transition: all 0.3s ease;
        }
        
        .calendar-day:hover {
            transform: scale(1.05);
        }
        
        .available {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .booked {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        
        .pending {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }
        
        .glass-effect {
            background: rgba(20, 20, 20, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .dark-card {
            background: rgba(15, 15, 15, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .section {
            min-height: 100vh;
            padding: 2rem;
        }
        
        .contact-icon {
            transition: transform 0.3s ease;
        }
        
        .contact-icon:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="min-h-full text-white tattoo-bg">
    <!-- Discreet Admin Logo -->
    <div class="fixed top-4 right-4 z-50">
        <button onclick="toggleAdminLogin()" class="text-gray-600 hover:text-red-400 transition-colors text-sm opacity-30 hover:opacity-100">
            ‚öôÔ∏è
        </button>
    </div>

    <!-- Home Section -->
    <section id="home" class="py-20 flex items-center justify-center">
        <div class="text-center max-w-3xl mx-auto px-4">
            <div class="mb-6">
                <svg class="w-16 h-16 mx-auto mb-4 text-red-400" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
            </div>
            <h1 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-red-400 to-orange-400 bg-clip-text text-transparent">
                SP Tattoo Ink
            </h1>
            <p class="text-lg text-gray-300 mb-6">Profesionalno tetoviranje ‚Ä¢ Sterilni uslovi ‚Ä¢ Iskusni umetnici</p>
            <div class="space-y-4">
                <a href="#booking" class="inline-block bg-gradient-to-r from-red-500 to-orange-500 px-6 py-3 rounded-lg font-semibold hover:from-red-600 hover:to-orange-600 transition-all transform hover:scale-105">
                    üóìÔ∏è Zaka≈æite Termin
                </a>
                <div>
                    <a href="#contact" class="text-gray-400 hover:text-red-400 transition-colors text-sm">Kontakt & Info ‚Üì</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Booking Section -->
    <section id="booking" class="section min-h-screen">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-8 text-red-400">Zakazivanje Termina</h2>
            
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Calendar -->
                <div class="glass-effect p-6 rounded-xl">
                    <h3 class="text-2xl font-semibold mb-4 text-center">Kalendar</h3>
                    <div class="mb-4 flex justify-between items-center">
                        <button onclick="changeMonth(-1)" class="bg-red-500 px-4 py-2 rounded hover:bg-red-600 transition-colors">‚Äπ</button>
                        <span id="currentMonth" class="text-xl font-semibold"></span>
                        <button onclick="changeMonth(1)" class="bg-red-500 px-4 py-2 rounded hover:bg-red-600 transition-colors">‚Ä∫</button>
                    </div>
                    <div class="grid grid-cols-7 gap-2 mb-4">
                        <div class="text-center font-semibold p-2">Pon</div>
                        <div class="text-center font-semibold p-2">Uto</div>
                        <div class="text-center font-semibold p-2">Sre</div>
                        <div class="text-center font-semibold p-2">ƒået</div>
                        <div class="text-center font-semibold p-2">Pet</div>
                        <div class="text-center font-semibold p-2">Sub</div>
                        <div class="text-center font-semibold p-2">Ned</div>
                    </div>
                    <div id="calendarDays" class="grid grid-cols-7 gap-2"></div>
                    
                    <div class="mt-4 text-sm">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-4 h-4 available rounded"></div>
                            <span>Dostupno</span>
                        </div>
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-4 h-4 pending rounded"></div>
                            <span>Na ƒçekanju</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 booked rounded"></div>
                            <span>Zauzeto</span>
                        </div>
                    </div>
                </div>

                <!-- Booking Form -->
                <div class="glass-effect p-6 rounded-xl">
                    <h3 class="text-2xl font-semibold mb-4">Podaci za Zakazivanje</h3>
                    <form id="bookingForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Izabrani Datum</label>
                            <input type="text" id="selectedDate" readonly class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Umetnik</label>
                            <select id="artist" required class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white">
                                <option value="">Izaberite umetnika</option>
                                <option value="Stefan Petroviƒá">Stefan Petroviƒá - Glavni umetnik</option>
                                <option value="Marko Jovanoviƒá">Marko Jovanoviƒá - Specijalizovan za realizam</option>
                                <option value="Ana Nikoliƒá">Ana Nikoliƒá - Fine line tetoviranje</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Tip Termina</label>
                            <select id="sessionType" required class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white" onchange="updatePrice()">
                                <option value="">Izaberite tip termina</option>
                                <option value="small" data-price="150" data-deposit="100">Small Tattoo - 150‚Ç¨ (Depozit: 100‚Ç¨)</option>
                                <option value="half" data-price="300" data-deposit="150">Half Day (3h) - 300‚Ç¨ (Depozit: 150‚Ç¨)</option>
                                <option value="full" data-price="600" data-deposit="250">Full Day (6h) - 600‚Ç¨ (Depozit: 250‚Ç¨)</option>
                            </select>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Ime</label>
                                <input type="text" id="firstName" required class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Prezime</label>
                                <input type="text" id="lastName" required class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Broj Telefona</label>
                            <input type="tel" id="phone" required class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Email Adresa</label>
                            <input type="email" id="email" required class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Opis ≈Ωeljene Tetovaze</label>
                            <textarea id="description" required rows="4" class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white" placeholder="Opi≈°ite detaljno ≈°ta ≈æelite da se tetovira..."></textarea>
                        </div>
                        
                        <div id="priceInfo" class="hidden bg-gray-800 p-4 rounded-lg">
                            <div class="text-lg font-semibold text-green-400">Ukupna Cena: <span id="totalPrice"></span></div>
                            <div class="text-md text-yellow-400">Depozit: <span id="depositAmount"></span></div>
                            <div class="text-sm text-gray-300 mt-2">Depozit se uplaƒáuje preko PayPal-a ili ke≈°</div>
                        </div>
                        
                        <button type="submit" class="w-full bg-gradient-to-r from-red-500 to-orange-500 py-3 rounded-lg font-semibold hover:from-red-600 hover:to-orange-600 transition-all">
                            Po≈°aljite Zahtev za Termin
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Login Modal -->
    <div id="adminModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="glass-effect p-8 rounded-xl max-w-md mx-4">
            <div id="adminLogin">
                <h2 class="text-2xl font-bold text-center mb-6 text-red-400">Admin Panel</h2>
                <form id="loginForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Korisniƒçko Ime</label>
                        <input type="text" id="adminUsername" required class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">≈†ifra</label>
                        <input type="password" id="adminPassword" required class="w-full p-3 bg-gray-800 rounded-lg border border-gray-600 text-white">
                    </div>
                    <div class="flex space-x-4">
                        <button type="submit" class="flex-1 bg-red-500 py-3 rounded-lg font-semibold hover:bg-red-600 transition-colors">
                            Prijavite se
                        </button>
                        <button type="button" onclick="closeAdminModal()" class="flex-1 bg-gray-600 py-3 rounded-lg font-semibold hover:bg-gray-700 transition-colors">
                            Otka≈æi
                        </button>
                    </div>
                </form>
            </div>

            <!-- Admin Dashboard -->
            <div id="adminDashboard" class="hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-red-400">Upravljanje Terminima</h2>
                    <button onclick="logout()" class="bg-gray-600 px-4 py-2 rounded hover:bg-gray-700 transition-colors">Odjavite se</button>
                </div>
                
                <div class="max-h-96 overflow-y-auto">
                    <h3 class="text-lg font-semibold mb-4">Zahtevi za Termine</h3>
                    <div id="pendingBookings" class="space-y-4">
                        <!-- Pending bookings will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Section -->
    <section id="contact" class="section py-16">
        <div class="max-w-4xl mx-auto">
            <div class="dark-card p-8 rounded-xl">
                <h2 class="text-3xl font-bold text-center mb-8 text-red-400">Kontakt & Informacije</h2>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Leva kolona -->
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-lg font-semibold mb-3 text-red-400 flex items-center">
                                üìç Adresa & Kontakt
                            </h3>
                            <div class="text-gray-300 space-y-2">
                                <p>Knez Mihailova 15, 11000 Beograd</p>
                                <p>
                                    <a href="mailto:sp.tattoo20@gmail.com" class="hover:text-red-400 transition-colors">
                                        üìß sp.tattoo20@gmail.com
                                    </a>
                                </p>
                                <p>
                                    <a href="https://wa.me/381601234567" target="_blank" rel="noopener noreferrer" class="hover:text-red-400 transition-colors">
                                        üì± WhatsApp: +381 60 123 4567
                                    </a>
                                </p>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="text-lg font-semibold mb-3 text-red-400 flex items-center">
                                üïí Radno Vreme
                            </h3>
                            <div class="text-gray-300 space-y-1">
                                <p>Ponedeljak - Petak: 10:00 - 20:00</p>
                                <p>Subota: 10:00 - 18:00</p>
                                <p class="text-red-400">Nedelja: Zatvoreno</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Desna kolona -->
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-lg font-semibold mb-3 text-red-400 flex items-center">
                                üí≥ Plaƒáanje
                            </h3>
                            <div class="text-gray-300 space-y-1">
                                <p>‚Ä¢ Ke≈° (RSD/EUR)</p>
                                <p>‚Ä¢ PayPal</p>
                                <p>‚Ä¢ Bankovna kartica</p>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="text-lg font-semibold mb-3 text-red-400 flex items-center">
                                ‚ÑπÔ∏è Napomene
                            </h3>
                            <div class="text-gray-300 space-y-1">
                                <p>‚Ä¢ Depozit pri zakazivanju</p>
                                <p>‚Ä¢ Besplatne konsultacije</p>
                                <p>‚Ä¢ Sterilni uslovi rada</p>
                                <p>‚Ä¢ Profesionalna oprema</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 text-center border-t border-gray-700 pt-6">
                    <p class="text-gray-400 mb-4">Pratite nas:</p>
                    <div class="flex justify-center space-x-6">
                        <a href="#" class="text-red-400 text-xl hover:text-red-300 transition-colors">üìò</a>
                        <a href="#" class="text-red-400 text-xl hover:text-red-300 transition-colors">üì∑</a>
                        <a href="#" class="text-red-400 text-xl hover:text-red-300 transition-colors">üê¶</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Modal -->
    <div id="successModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="glass-effect p-8 rounded-xl max-w-md mx-4">
            <div class="text-center">
                <div class="text-green-400 text-6xl mb-4">‚úì</div>
                <h3 class="text-2xl font-bold mb-4">Zahtev Poslat!</h3>
                <p class="text-gray-300 mb-6" id="successMessage">Va≈° zahtev za termin je uspe≈°no poslat. Biƒáete obave≈°teni putem email-a o potvrdi termina.</p>
                <button onclick="closeModal()" class="bg-red-500 px-6 py-2 rounded hover:bg-red-600 transition-colors">Zatvorite</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyClHS0XqvG0k5k5yWMZkxH_MCOUtIFxHFg",
            authDomain: "sp-tattoo.firebaseapp.com",
            projectId: "sp-tattoo",
            storageBucket: "sp-tattoo.firebasestorage.app",
            messagingSenderId: "830314471901",
            appId: "1:830314471901:web:7949e462ddff666893d634"
        };

        // Initialize Firebase
        let db = null;
        let firebaseConnected = false;
        
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            firebaseConnected = true;
            console.log("Firebase uspe≈°no povezan!");
        } catch (error) {
            console.error("Gre≈°ka pri povezivanju sa Firebase:", error);
            console.log("Sajt radi u demo re≈æimu bez baze podataka");
        }

        // EmailJS Configuration
        let emailjsConnected = false;
        
        try {
            emailjs.init("YOUR_EMAILJS_PUBLIC_KEY"); // Trebate da unesete va≈° Public Key iz EmailJS
            emailjsConnected = true;
            console.log("EmailJS uspe≈°no povezan!");
        } catch (error) {
            console.error("Gre≈°ka pri povezivanju sa EmailJS:", error);
            console.log("Email funkcionalnost nije dostupna");
        }

        // Global Variables
        let currentDate = new Date();
        let selectedDateElement = null;
        let bookings = {};

        // Admin Modal Functions
        function toggleAdminLogin() {
            document.getElementById('adminModal').classList.remove('hidden');
        }
        
        function closeAdminModal() {
            document.getElementById('adminModal').classList.add('hidden');
            document.getElementById('adminUsername').value = '';
            document.getElementById('adminPassword').value = '';
        }

        // Initialize calendar when booking section comes into view
        function initializeBookingSection() {
            generateCalendar();
            loadBookings();
        }
        
        // Intersection Observer for lazy loading
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && entry.target.id === 'booking') {
                    initializeBookingSection();
                }
            });
        });
        
        // Observe booking section
        document.addEventListener('DOMContentLoaded', function() {
            const bookingSection = document.getElementById('booking');
            if (bookingSection) {
                observer.observe(bookingSection);
            }
        });

        // Calendar Functions
        function generateCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            document.getElementById('currentMonth').textContent = 
                new Date(year, month).toLocaleDateString('sr-RS', { month: 'long', year: 'numeric' });
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - (firstDay.getDay() === 0 ? 6 : firstDay.getDay() - 1));
            
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';
            
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day p-3 text-center cursor-pointer rounded-lg';
                dayElement.textContent = date.getDate();
                
                const dateString = date.toISOString().split('T')[0];
                const today = new Date().toISOString().split('T')[0];
                
                if (date.getMonth() !== month) {
                    dayElement.className += ' text-gray-500 cursor-not-allowed';
                } else if (dateString < today) {
                    dayElement.className += ' text-gray-600 cursor-not-allowed';
                } else {
                    const booking = bookings[dateString];
                    if (booking) {
                        if (booking.status === 'confirmed') {
                            dayElement.className += ' booked';
                        } else {
                            dayElement.className += ' pending';
                        }
                    } else {
                        dayElement.className += ' available';
                        dayElement.onclick = () => selectDate(date, dayElement);
                    }
                }
                
                calendarDays.appendChild(dayElement);
            }
        }

        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            generateCalendar();
        }

        function selectDate(date, element) {
            if (selectedDateElement) {
                selectedDateElement.classList.remove('ring-4', 'ring-yellow-400');
            }
            
            selectedDateElement = element;
            element.classList.add('ring-4', 'ring-yellow-400');
            
            document.getElementById('selectedDate').value = 
                date.toLocaleDateString('sr-RS', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
        }

        function updatePrice() {
            const sessionType = document.getElementById('sessionType');
            const selectedOption = sessionType.options[sessionType.selectedIndex];
            
            if (selectedOption.value) {
                const price = selectedOption.dataset.price;
                const deposit = selectedOption.dataset.deposit;
                
                document.getElementById('totalPrice').textContent = price + '‚Ç¨';
                document.getElementById('depositAmount').textContent = deposit + '‚Ç¨';
                document.getElementById('priceInfo').classList.remove('hidden');
            } else {
                document.getElementById('priceInfo').classList.add('hidden');
            }
        }

        // Booking Functions
        async function loadBookings() {
            if (!firebaseConnected || !db) {
                console.log('Firebase nije povezan - koristim demo podatke');
                // Demo podaci za testiranje
                bookings = {
                    '2024-01-15': { status: 'confirmed', artist: 'Stefan Petroviƒá' },
                    '2024-01-20': { status: 'pending', artist: 'Ana Nikoliƒá' }
                };
                generateCalendar();
                return;
            }
            
            try {
                const snapshot = await db.collection('bookings').get();
                bookings = {};
                snapshot.forEach(doc => {
                    const data = doc.data();
                    bookings[data.date] = { ...data, id: doc.id };
                });
                generateCalendar();
            } catch (error) {
                console.error('Gre≈°ka pri uƒçitavanju termina:', error);
                generateCalendar();
            }
        }

        document.getElementById('bookingForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const selectedDate = document.getElementById('selectedDate').value;
            if (!selectedDate) {
                showCustomAlert('Molimo izaberite datum!', 'error');
                return;
            }
            
            const formData = {
                date: selectedDateElement ? 
                    new Date(currentDate.getFullYear(), currentDate.getMonth(), 
                    parseInt(selectedDateElement.textContent)).toISOString().split('T')[0] : '',
                artist: document.getElementById('artist').value,
                sessionType: document.getElementById('sessionType').value,
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                description: document.getElementById('description').value,
                status: 'pending',
                timestamp: new Date().toISOString()
            };
            
            // Show loading state
            const submitButton = e.target.querySelector('button[type="submit"]');
            const originalText = submitButton.textContent;
            submitButton.textContent = '≈†alje se...';
            submitButton.disabled = true;
            
            try {
                let firebaseSaved = false;
                let emailSent = false;
                
                // Save to Firebase if connected
                if (firebaseConnected && db) {
                    try {
                        await db.collection('bookings').add(formData);
                        firebaseSaved = true;
                        console.log('Podaci saƒçuvani u Firebase');
                    } catch (fbError) {
                        console.error('Firebase gre≈°ka:', fbError);
                        showCustomAlert('Gre≈°ka pri ƒçuvanju u bazu podataka', 'error');
                    }
                }
                
                // Send email notification if EmailJS is connected
                if (emailjsConnected) {
                    try {
                        await emailjs.send('service_sptattoo', 'template_sptattoo', {
                            to_email: 'sp.tattoo20@gmail.com',
                            from_name: formData.firstName + ' ' + formData.lastName,
                            from_email: formData.email,
                            phone: formData.phone,
                            date: selectedDate,
                            artist: formData.artist,
                            session_type: formData.sessionType,
                            description: formData.description
                        });
                        emailSent = true;
                        console.log('Email poslat');
                    } catch (emailError) {
                        console.error('EmailJS gre≈°ka:', emailError);
                        showCustomAlert('Gre≈°ka pri slanju email-a', 'error');
                    }
                }
                
                // Show success modal with appropriate message
                const successMessage = document.getElementById('successMessage');
                if (firebaseSaved && emailSent) {
                    successMessage.textContent = 'Va≈° zahtev za termin je uspe≈°no poslat i saƒçuvan. Biƒáete obave≈°teni putem email-a o potvrdi termina.';
                } else if (firebaseSaved && !emailjsConnected) {
                    successMessage.textContent = 'Zahtev je saƒçuvan! Email funkcionalnost nije konfigurirana - kontaktiraƒáemo vas telefonom.';
                } else if (!firebaseConnected && !emailjsConnected) {
                    successMessage.textContent = 'Demo re≈æim: Forma je testirana uspe≈°no! Za pravu funkcionalnost konfiguri≈°ite Firebase i EmailJS.';
                } else {
                    successMessage.textContent = 'Zahtev je delimiƒçno obraƒëen. Molimo kontaktirajte nas direktno na sp.tattoo20@gmail.com';
                }
                
                document.getElementById('successModal').classList.remove('hidden');
                
                // Reset form
                document.getElementById('bookingForm').reset();
                document.getElementById('priceInfo').classList.add('hidden');
                if (selectedDateElement) {
                    selectedDateElement.classList.remove('ring-4', 'ring-yellow-400');
                    selectedDateElement = null;
                }
                
                // Reload bookings
                loadBookings();
                
            } catch (error) {
                console.error('Op≈°ta gre≈°ka:', error);
                showCustomAlert('Do≈°lo je do neoƒçekivane gre≈°ke. Molimo poku≈°ajte ponovo.', 'error');
            } finally {
                // Reset button state
                submitButton.textContent = originalText;
                submitButton.disabled = false;
            }
        });

        function closeModal() {
            document.getElementById('successModal').classList.add('hidden');
        }

        // Custom Alert Function
        function showCustomAlert(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `fixed top-4 left-1/2 transform -translate-x-1/2 z-50 p-4 rounded-lg shadow-lg max-w-md ${
                type === 'error' ? 'bg-red-600' : type === 'success' ? 'bg-green-600' : 'bg-blue-600'
            } text-white`;
            alertDiv.innerHTML = `
                <div class="flex items-center justify-between">
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">‚úï</button>
                </div>
            `;
            document.body.appendChild(alertDiv);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (alertDiv.parentElement) {
                    alertDiv.remove();
                }
            }, 5000);
        }

        // Admin Functions
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            // Simple authentication - u produkciji koristite sigurniju metodu
            if (username === 'admin' && password === 'sp2024tattoo') {
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                loadPendingBookings();
                showCustomAlert('Uspe≈°no ste se prijavili!', 'success');
            } else {
                showCustomAlert('Neispravno korisniƒçko ime ili ≈°ifra!', 'error');
            }
        });

        function logout() {
            document.getElementById('adminLogin').classList.remove('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            closeAdminModal();
        }

        async function loadPendingBookings() {
            const container = document.getElementById('pendingBookings');
            
            if (!firebaseConnected || !db) {
                container.innerHTML = '<p class="text-gray-400 text-center">Demo re≈æim - Firebase nije povezan.<br>Konfiguri≈°ite Firebase za punu funkcionalnost.</p>';
                return;
            }
            
            try {
                const snapshot = await db.collection('bookings')
                    .where('status', '==', 'pending')
                    .orderBy('timestamp', 'desc')
                    .get();
                
                container.innerHTML = '';
                
                if (snapshot.empty) {
                    container.innerHTML = '<p class="text-gray-400 text-center">Nema novih zahteva za termine.</p>';
                    return;
                }
                
                snapshot.forEach(doc => {
                    const booking = doc.data();
                    const bookingElement = createBookingElement(booking, doc.id);
                    container.appendChild(bookingElement);
                });
            } catch (error) {
                console.error('Gre≈°ka pri uƒçitavanju zahteva:', error);
                container.innerHTML = '<p class="text-red-400 text-center">Gre≈°ka pri uƒçitavanju podataka.</p>';
            }
        }

        function createBookingElement(booking, id) {
            const div = document.createElement('div');
            div.className = 'bg-gray-800 p-4 rounded-lg';
            div.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h4 class="font-semibold text-lg">${booking.firstName} ${booking.lastName}</h4>
                        <p class="text-gray-300">üìÖ ${new Date(booking.date).toLocaleDateString('sr-RS')}</p>
                        <p class="text-gray-300">üë®‚Äçüé® ${booking.artist}</p>
                        <p class="text-gray-300">‚è±Ô∏è ${booking.sessionType}</p>
                        <p class="text-gray-300">üìû ${booking.phone}</p>
                        <p class="text-gray-300">üìß ${booking.email}</p>
                    </div>
                    <div>
                        <p class="text-gray-300 mb-2"><strong>Opis:</strong></p>
                        <p class="text-sm text-gray-400 mb-4">${booking.description}</p>
                        <div class="space-x-2">
                            <button onclick="confirmBooking('${id}', '${booking.email}', '${booking.firstName}', '${booking.date}')" 
                                    class="bg-green-500 px-4 py-2 rounded hover:bg-green-600 transition-colors">
                                Potvrdi
                            </button>
                            <button onclick="rejectBooking('${id}', '${booking.email}', '${booking.firstName}')" 
                                    class="bg-red-500 px-4 py-2 rounded hover:bg-red-600 transition-colors">
                                Odbaci
                            </button>
                        </div>
                    </div>
                </div>
            `;
            return div;
        }

        async function confirmBooking(id, email, firstName, date) {
            try {
                await db.collection('bookings').doc(id).update({
                    status: 'confirmed'
                });
                
                // Send confirmation email
                await emailjs.send('service_sptattoo', 'template_h1zimtv', {
                    to_email: email,
                    to_name: firstName,
                    date: new Date(date).toLocaleDateString('sr-RS'),
                    message: 'Va≈° termin je potvrƒëen! Molimo uplatite depozit preko PayPal-a ili ke≈° u studiju.'
                });
                
                showCustomAlert('Termin je potvrƒëen i email je poslat klijentu!', 'success');
                loadPendingBookings();
                loadBookings();
            } catch (error) {
                console.error('Gre≈°ka:', error);
                showCustomAlert('Do≈°lo je do gre≈°ke pri potvrƒëivanju termina.', 'error');
            }
        }

        async function rejectBooking(id, email, firstName) {
            try {
                await db.collection('bookings').doc(id).delete();
                
                // Send rejection email
                await emailjs.send('service_sptattoo', 'template_h1zimtv', {
                    to_email: email,
                    to_name: firstName,
                    message: 'Na≈æalost, va≈° zahtev za termin nije mogao biti prihvaƒáen. Molimo kontaktirajte nas za alternativne termine.'
                });
                
                showCustomAlert('Termin je odbaƒçen i email je poslat klijentu!', 'success');
                loadPendingBookings();
                loadBookings();
            } catch (error) {
                console.error('Gre≈°ka:', error);
                showCustomAlert('Do≈°lo je do gre≈°ke pri odbacivanju termina.', 'error');
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Page is ready - all sections are visible for scrolling
            console.log('SP Tattoo Ink website loaded successfully');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98e7d384831337eb',t:'MTc2MDQ1Mjc2Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
